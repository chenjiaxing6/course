## 大章列表查询
增加模块business，将system的依赖复制过来。

复制system中的config和controller并修改（shift+f6 快速重构）

复制配置文件和logback.xml，修改（端口号9002）

生成代码，修改generatorConfig.xml

> 可以将常用的文件拖动到左下角的favorites，这样便于查找

server中增加dto（domain是数据库生成的不允许修改，domain作用与service和mapper，dto作用于service和controller）

server增加service:
```java
@Service
public class ChapterService {
    @Resource
    private ChapterMapper chapterMapper;


    public List<ChapterDto> list() {
        ChapterExample chapterExample = new ChapterExample();
        List<Chapter> chapters = chapterMapper.selectByExample(chapterExample);
        List<ChapterDto> chapterDtoList = new ArrayList<>();
        for (int i = 0; i < chapters.size(); i++) {
            Chapter chapter = chapters.get(i);
            ChapterDto chapterDto = new ChapterDto();
            BeanUtils.copyProperties(chapter, chapterDto);
            chapterDtoList.add(chapterDto);
        }
        return chapterDtoList;
    }

}
```
business中增加controller：
```java
@RestController
@RequestMapping("/admin")
public class ChapterController {
    @Resource
    private ChapterService chapterService;

    @RequestMapping("/hello")
    public String helloWorld() {
        return "success";
    }

    @RequestMapping("/chapter")
    public List<ChapterDto> chapter() {
        return chapterService.list();
    }

}
```

## 大章列表前端
新建chapter组件：
```html
<template>
  <div>
    <h2>大章页面</h2>
  </div>
</template>
```
新增路由：
```javascript
{
        path: '/admin',
        component: Admin,
        children: [
            {
                path: 'welcome',
                component: Welcome,
            },
            {
                path: 'chapter',
                component: Chapter,
            }]
    }
```
将对应的数据列表的元素放入chapter.vue

### 点击侧边栏实现跳转功能实现
1.点击激活样式实现

在admin.vue中增加方法：
```javascript
/**
     * 菜单激活样式，id是当前点击的菜单的id
     * @param id
     */
    activeSidebar: function (id) {
      // 兄弟菜单去掉active样式，自身增加active样式
      $("#" + id).siblings().removeClass("active");
      $("#" + id).siblings().find("li").removeClass("active");
      $("#" + id).addClass("active");
      // 如果有父菜单，父菜单的兄弟菜单去掉open active，父菜单增加open active
      let parentLi = $("#" + id).parents("li");
      if (parentLi) {
        parentLi.siblings().removeClass("open active");
        parentLi.addClass("open active");
      }
    }
```
设置菜单的id：这个id要和路由一样
```javascript
    // 欢迎页面就叫
    <li class="" id="welcome-sidebar">
    // 大章管理就叫
    <li class="active" id="business-chapter-sidebar">
```

在login.vue中加入：
```javascript
export default {
  name: "welcome",
  mounted: function() {
    this.$parent.activeSidebar("welcome-sidebar");
  },
  methods: {
  }
}
</script>
```
在chapter.vue中加入：
```javascript
export default {
  name: "welcome",
  mounted: function () {
    this.$parent.activeSidebar("business-chapter-sidebar")
  },
  methods: {}
}
```
2.点击实现页面跳转
将原来的a标签改为router-link:
```html
 <li class="" id="welcome-sidebar">
   <router-link to="/admin/welcome">
     <i class="menu-icon fa fa-tachometer"></i>
     <span class="menu-text"> 欢迎 </span>
   </router-link>

   <b class="arrow"></b>
 </li>
```

3.点击激活通用方法提取

将路由的admin去掉，并为每个路由加name属性。

在admin.vue增加watch监听：
```javascript
mounted: function () {
    let _this = this;
    $("body").removeClass("login-layout light-login");
    $("body").attr("class", "no-skin");
    _this.activeSidebar(_this.$route.name.replace("/","-")+"-sidebar");
  },
  watch: {
    $route: {
      handler:function(val, oldVal){
        console.log("---->页面跳转：", val, oldVal);
        let _this = this;
        _this.$nextTick(function (){    //页面加载完成后执行
          _this.activeSidebar(_this.$route.name.replace("/","-")+"-sidebar");
        })
      }
    }
  }
```
> watch监听可以拿到路由前的页面和路由后的页面，通过路由的name去查找id，然后在调用activeSidebar方法

### 使用axios实现前后端交互
npm install axios --save

以vue属性的方式使用axios：修改main.js
```
import axios from 'axios';
Vue.prototype.$ajax = axios;
```

在chapter.vue中使用：
```javascript
list() {
      let _this = this;
      _this.$ajax.get('http://127.0.0.1:9000/business/admin/chapter/list').then((response) => {
        console.log("查询大章列表结果：", response);
        _this.chapters = response.data;
      })
    }
```
在mounted中调用:
```javascript
let _this = this;
_this.list();
```
**解决跨域问题：**

在server中添加配置 ：
```java
@Configuration
public class CorsConfig implements WebMvcConfigurer {

    @Override
    public void addCorsMappings(CorsRegistry registry) {
        registry.addMapping("/**")
                .allowedOrigins("*")
                .allowedHeaders(CorsConfiguration.ALL)
                .allowedMethods(CorsConfiguration.ALL)
                .allowCredentials(true)
                .maxAge(3600);
    }
}
```
显示真实数据：

定义数据模型，并将相应数据绑定给chapters
```javascript
data: function () {
    return {
      chapters: []
    }
}

_this.$ajax.get('http://127.0.0.1:9002/business/admin/chapter/list').then((response) => {
    _this.chapters = response.data;
})
```

在html中遍历显示：
```html
<tr v-for="chapter in chapters">
      <td>{{ chapter.id }}</td>
      <td>{{ chapter.name }}</td>
      <td>{{ chapter.courseId }}</td>
</tr>
```